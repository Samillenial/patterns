package structural.proxy

class ImageProxy(user: String, password: String): IGraphic {

    private var downloaded: Boolean = false
    private var image: IGraphic = RemoteImage("data:image/jpeg;base64,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")
    val access: Boolean
        get() {
            if(!field)
                println("Error en la autenticaci√≥n")
            return field
        }


    init {
        access = (user=="1234" && password == "4321")
    }

    override fun draw() {
        println("ImageProxy: draw")
        if(!access)
            return
        if(checkLoad())
            image.draw()
    }

    override fun getExtents(): String {
        println("ImageProxy: getExtent")
        if(!access)
            return ""
        return image.getExtents()
    }

    override fun load(): Boolean {
        println("ImageProxy: load")
        if(!access)
            return false

        if(image.load())
            downloaded = true

        return downloaded
    }

    override fun store(path: String): Boolean {
        println("ImageProxy: store")
        if(!access)
            return false

        return if(checkLoad())
            image.store(path)
        else
            false
    }

    override fun getImage() : String {
        println("ImageProxy: getImage")
        if(!access)
            return ""

        return image.getImage()
    }

    private fun checkLoad(): Boolean {
       return if (!downloaded)
            image.load()
        else
            true
    }
}